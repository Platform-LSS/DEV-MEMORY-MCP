{{define "content"}}
<div>
  <div class="flex items-center justify-between mb-6">
    <div>
      <h2 class="text-2xl font-bold mb-1">Memories</h2>
      <p class="text-sm text-zinc-500">Browse, edit, and create memory entries</p>
    </div>
    <button onclick="document.getElementById('create-form').classList.toggle('hidden')"
            class="px-4 py-2 bg-brand-600 hover:bg-brand-700 text-white text-sm font-medium rounded-lg transition-colors">
      + New Memory
    </button>
  </div>

  <!-- Create form (hidden by default) -->
  <div id="create-form" class="hidden mb-6 bg-zinc-900 border border-zinc-800 rounded-xl p-6">
    <h3 class="text-lg font-semibold mb-4">Create Memory</h3>
    <form hx-post="/api/memories" hx-target="#memory-list" hx-swap="innerHTML" class="space-y-4">
      <div class="grid grid-cols-3 gap-4">
        <div>
          <label class="block text-sm text-zinc-400 mb-1">Project</label>
          <select name="project_id" class="w-full px-3 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-zinc-100 focus:outline-none focus:border-brand-500">
            {{range .Groups}}
            <option value="{{.Project.ID}}">{{.Project.Name}}</option>
            {{end}}
          </select>
        </div>
        <div>
          <label class="block text-sm text-zinc-400 mb-1">Topic</label>
          <input type="text" name="topic" placeholder="e.g. architecture" class="w-full px-3 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-zinc-100 focus:outline-none focus:border-brand-500" />
        </div>
        <div>
          <label class="block text-sm text-zinc-400 mb-1">Key</label>
          <input type="text" name="key" placeholder="e.g. database-choice" class="w-full px-3 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-zinc-100 focus:outline-none focus:border-brand-500" />
        </div>
      </div>
      <div>
        <label class="block text-sm text-zinc-400 mb-1">Value</label>
        <textarea name="value" rows="3" placeholder="Memory content..." class="w-full px-3 py-2 bg-zinc-800 border border-zinc-700 rounded-lg text-zinc-100 focus:outline-none focus:border-brand-500"></textarea>
      </div>
      <button type="submit" class="px-4 py-2 bg-brand-600 hover:bg-brand-700 text-white text-sm font-medium rounded-lg transition-colors">
        Save Memory
      </button>
    </form>
  </div>

  <div class="flex gap-6">
    <!-- Sidebar: projects + topics -->
    <div class="w-64 shrink-0 space-y-4">
      {{range .Groups}}
      <div>
        <p class="text-sm font-semibold text-zinc-300 mb-2">{{.Project.Name}}</p>
        <div class="space-y-1 pl-2">
          <a hx-get="/api/memories?project={{.Project.ID}}" hx-target="#memory-list" hx-swap="innerHTML"
             class="block px-3 py-1.5 text-sm text-zinc-400 hover:text-zinc-200 hover:bg-zinc-800 rounded cursor-pointer">
            All memories
          </a>
          {{$pid := .Project.ID}}
          {{range .Topics}}
          <a hx-get="/api/memories?project={{$pid}}&topic={{.}}" hx-target="#memory-list" hx-swap="innerHTML"
             class="block px-3 py-1.5 text-sm text-zinc-500 hover:text-zinc-300 hover:bg-zinc-800 rounded cursor-pointer">
            {{.}}
          </a>
          {{end}}
        </div>
      </div>
      {{end}}
      {{if not .Groups}}
      <p class="text-zinc-500 text-sm">No projects yet</p>
      {{end}}
    </div>

    <!-- Memory list -->
    <div id="memory-list" class="flex-1">
      <p class="text-zinc-500 p-4">Select a project or topic to view memories</p>
    </div>
  </div>
</div>
{{end}}

{{define "memories.html"}}{{template "layout.html" .}}{{end}}
